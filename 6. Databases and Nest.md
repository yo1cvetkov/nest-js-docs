# Databases with Nest

Services doesn't directly talk to the Database but instead there is an extra layer between the database and service which is **ORM** (Object Relational Mapping).

### ORM (Object Relational Mapping)

ORM can be divided in two parts:

- Abstraction Layer for User methods - these methods we use to perform different operations on the database
- Query language like SQL

No need for queries for a simple stuff like:

```sql
SELECT * FROM users WHERE id = 132;
```

Could be written as:

```typescript
const user = await userRepository.findOne(id);
```

Also there is a support for much complicated queries like:

```sql
SELECT * FROM users WHERE rating > 4 AND lastActive >= DATE_SUB(NOW(), INTERVAL 1 WEEK) AND amountSpent > 1200
```

Could be written as:

```typescript
usersRepository.find({
  where: {
    rating: { gt: 4 },
    lastActive: {
      gte: () => "CURRENT_DATE - INTERVAL '7 days'",
    },
    amountSpent: { gt: 1200 },
  },
});
```

Another advantage of using the ORM is switching the databases without having to change the exact code of the ORM.
